```dataviewjs

const tagsFolder = "Tags";
let existingTags = [];

try {
    const tagsFolderObj = app.vault.getAbstractFileByPath(tagsFolder);
    if (tagsFolderObj && tagsFolderObj.children) {
        existingTags = tagsFolderObj.children
            .filter(file => file.name.endsWith('.md'))
            .map(file => file.name.replace('.md', ''))
            .sort();
    }
} catch (error) {
    console.log("Tags folder may not exist yet:", error);
}

const formContainer = dv.el("div", "", { cls: "tag-form-container" });
formContainer.style.marginBottom = "20px";
formContainer.style.display = "flex";
formContainer.style.alignItems = "center";
formContainer.style.gap = "10px";

const tagInput = dv.el("input", "", { 
    attr: { 
        type: "text", 
        id: "tagInput",
        placeholder: "Enter tag name (e.g., Email, SOS, Urgent)"
    },
    cls: "tag-input"
});
tagInput.style.padding = "8px";
tagInput.style.border = "1px solid #ccc";
tagInput.style.borderRadius = "4px";
tagInput.style.flex = "1";
tagInput.style.fontSize = "14px";

const submitButton = dv.el("button", "Submit", { attr: { id: "submitTag" } });
submitButton.style.padding = "8px 16px";
submitButton.style.backgroundColor = "#4CAF50";
submitButton.style.color = "white";
submitButton.style.border = "none";
submitButton.style.borderRadius = "4px";
submitButton.style.cursor = "pointer";
submitButton.style.fontSize = "14px";

formContainer.appendChild(tagInput);
formContainer.appendChild(submitButton);
dv.container.appendChild(formContainer);

const tableContainer = dv.el("div", "", { attr: { id: "tagsTableContainer" } });
dv.container.appendChild(tableContainer);

function showNotification(message, isError = false) {
    const notification = document.createElement("div");
    notification.textContent = message;
    notification.style.position = "fixed";
    notification.style.top = "20px";
    notification.style.right = "20px";
    notification.style.padding = "12px 20px";
    notification.style.backgroundColor = isError ? "#f44336" : "#4CAF50";
    notification.style.color = "white";
    notification.style.borderRadius = "4px";
    notification.style.zIndex = "10000";
    notification.style.boxShadow = "0 2px 8px rgba(0,0,0,0.2)";
    notification.style.fontSize = "14px";
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.style.opacity = "0";
        notification.style.transition = "opacity 0.3s";
        setTimeout(() => {
            if (notification.parentNode) {
                notification.parentNode.removeChild(notification);
            }
        }, 300);
    }, 3000);
}

async function createTagDocument(tagName) {
    const input = document.getElementById("tagInput");
    if (!input) return;
    
    input.disabled = true;
    const originalValue = input.value;
    
    try {
        const sanitizedTag = tagName.trim().replace(/[^a-zA-Z0-9]/g, '');
        
        if (!sanitizedTag) {
            showNotification("Please enter a valid tag name", true);
            input.disabled = false;
            input.focus();
            return;
        }
        
        const tagFilePath = `${tagsFolder}/${sanitizedTag}.md`;
        const existingFile = app.vault.getAbstractFileByPath(tagFilePath);
        
        if (existingFile) {
            showNotification(`Tag "${sanitizedTag}" already exists!`, true);
            input.disabled = false;
            input.focus();
            return;
        }
        
        let tagsFolderObj = app.vault.getAbstractFileByPath(tagsFolder);
        if (!tagsFolderObj) {
            try {
                tagsFolderObj = await app.vault.createFolder(tagsFolder);
            } catch (error) {
                tagsFolderObj = app.vault.getAbstractFileByPath(tagsFolder);
                if (!tagsFolderObj) {
                    throw new Error("Could not create or access Tags folder: " + error.message);
                }
            }
        }
        
        let templateContent = "";
        try {
            const templateFile = app.vault.getAbstractFileByPath("Logic.md");
            if (templateFile) {
                templateContent = await app.vault.read(templateFile);
                templateContent = templateContent.replace(/^```dataviewjs\n?/, '').replace(/\n?```\s*$/, '');
            } else {
                throw new Error("Template file Logic.md not found");
            }
        } catch (error) {
            console.error("Error reading template:", error);
            showNotification("Error: Could not read template file Logic.md. Please ensure the file exists.", true);
            input.disabled = false;
            input.focus();
            return;
        }
        
        templateContent = templateContent.replace(/TAGNAME/g, sanitizedTag);
        
        const finalContent = "```dataviewjs\n\n" + templateContent + "\n\n```";
        
        await app.vault.create(tagFilePath, finalContent);
        
        input.value = "";
        input.disabled = false;
        
        setTimeout(() => {
            input.focus();
        }, 0);
        
        setTimeout(() => {
            renderTagsTable();
        }, 50);
        
        showNotification(`Tag "${sanitizedTag}" created successfully!`);
        
    } catch (error) {
        console.error("Error creating tag document:", error);
        showNotification("Error creating tag document: " + error.message, true);
        input.disabled = false;
        input.value = originalValue;
        input.focus();
    }
}

function renderTagsTable() {
    const container = document.getElementById("tagsTableContainer");
    if (!container) {
        console.error("Table container not found");
        return;
    }
    
    container.innerHTML = "";
    
    let currentTags = [];
    try {
        const tagsFolderObj = app.vault.getAbstractFileByPath(tagsFolder);
        if (tagsFolderObj && tagsFolderObj.children) {
            currentTags = tagsFolderObj.children
                .filter(file => file.name.endsWith('.md'))
                .map(file => file.name.replace('.md', ''))
                .sort();
        }
    } catch (error) {
        console.log("Error reading tags folder:", error);
    }
    
    existingTags = currentTags;
    
    const table = document.createElement("table");
    table.style.width = "100%";
    table.style.borderCollapse = "collapse";
    table.style.marginTop = "10px";
    
    const thead = document.createElement("thead");
    const headerRow = document.createElement("tr");
    
    ["Tag Name"].forEach(header => {
        const th = document.createElement("th");
        th.textContent = header;
        th.style.border = "1px solid #ddd";
        th.style.padding = "10px";
        th.style.textAlign = "left";
        th.style.backgroundColor = "#f2f2f2";
        headerRow.appendChild(th);
    });
    
    thead.appendChild(headerRow);
    table.appendChild(thead);
    
    const tbody = document.createElement("tbody");
    
    if (currentTags.length === 0) {
        const placeholderRow = document.createElement("tr");
        
        const placeholderCell = document.createElement("td");
        placeholderCell.textContent = "No Tags have been created";
        placeholderCell.style.border = "1px solid #ddd";
        placeholderCell.style.padding = "10px";
        placeholderCell.style.color = "#666";
        placeholderCell.style.fontStyle = "italic";
        placeholderCell.setAttribute("colspan", "1");
        placeholderCell.style.textAlign = "center";
        
        placeholderRow.appendChild(placeholderCell);
        tbody.appendChild(placeholderRow);
    } else {
        currentTags.forEach(tag => {
            const row = document.createElement("tr");
            
            const tagCell = document.createElement("td");
            tagCell.textContent = tag;
            tagCell.style.border = "1px solid #ddd";
            tagCell.style.padding = "10px";
            tagCell.style.cursor = "pointer";
            tagCell.style.color = "#4A90E2";
            tagCell.style.textDecoration = "underline";
            
            tagCell.addEventListener("click", async () => {
                try {
                    const filePath = `${tagsFolder}/${tag}.md`;
                    const file = app.vault.getAbstractFileByPath(filePath);
                    if (file) {
                        await app.workspace.open(file);
                    }
                } catch (error) {
                    console.error("Error opening file:", error);
                }
            });
            
            row.appendChild(tagCell);
            tbody.appendChild(row);
        });
    }
    
    table.appendChild(tbody);
    container.appendChild(table);
}

setTimeout(() => {
    const submitBtn = document.getElementById("submitTag");
    const input = document.getElementById("tagInput");
    
    if (submitBtn) {
        submitBtn.addEventListener("click", async (e) => {
            e.preventDefault(); // Prevent any default behavior
            const tagName = input.value.trim();
            if (tagName) {
                await createTagDocument(tagName);
            } else {
                showNotification("Please enter a tag name", true);
            }
        });
    }
    
    if (input) {
        input.addEventListener("keypress", async (e) => {
            if (e.key === "Enter") {
                e.preventDefault(); // Prevent form submission
                const tagName = input.value.trim();
                if (tagName) {
                    await createTagDocument(tagName);
                } else {
                    showNotification("Please enter a tag name", true);
                }
            }
        });
    }
    
    renderTagsTable();
}, 100);

```

